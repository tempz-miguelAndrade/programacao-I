<meta charset="UTF-8">
<script>
	/*## Problema 2: Gestor de Notas e Médias de Alunos

Contexto: Um professor precisa de um sistema para registrar as notas dos seus 5 alunos em 4 bimestres, calcular médias e identificar alunos com desempenho baixo.

### Requisitos:
1. Função para validar notas: Valide se a nota está entre 0 e 10 (use while).
2. Função para adicionar notas: Insira as 4 notas de cada aluno usando for.
3. Função para calcular média: Use for para somar as notas e calcular a média.
4. Função para classificar desempenho: Use if...else aninhado:
	 - Média >= 9: Excelente
	 - Média >= 7: Bom
	 - Média >= 5: Regular
	 - Média < 5: Insuficiente
5. Função para gerar relatório: Mostre o nome, notas, média e classificação de cada aluno.

Dados Iniciais:

```javascript
let alunos = ["João", "Maria", "Pedro", "Ana", "Carlos"];
let notas = [
	// cada elemento é um array com 4 notas, ex: [8, 7.5, 9, 10]
];


> **DESAFIO:** Implemente um sistema completo onde o professor possa cadastrar notas, remover um aluno se necessário, visualizar relatórios e tudo validado adequadamente.
## Problema 3: Sistema de Estoque de Produtos com Preço
*/

	/*Acho que adicionei muitos conentários sksksksksk, medo de errar a explicação, sempre fico precionado */

	// dados iniciais
	let alunos = ["João", "Maria", "Pedro", "Ana", "Carlos"];
	let notas = [];


	/*
	// formalizar texto
	function normalizar(texto) {
		return texto
			.toLowerCase()
			.normalize("NFD")
			.replace(/[\u0300-\u036f]/g, "");
	}

	tentei utilizar essa função mas não soube te explicar porque peguei do google, então deixei comentada para utilização futura
	*/



	// telas iniciais
	function telaInicial1() {
		let perguntaInicial = validador(`O que deseja realizar?\n\n1. Remover aluno;\n2. Aplicar as notas.`);

		// opções
		if (perguntaInicial == 1) {
			return removerAluno();
		} else if (perguntaInicial == 2) {
			return adicionarNotas();
		} else {
			alert(`Opção inválida!`);
			return telaInicial1();
		}
	}



	function telaInicial2() {

		// pergunta 2 modificada
		perguntaInicial = validador(`O que deseja realizar?\n\n1. Remover aluno;\n2. Ver relatório;\n3. Reiniciar.`);

		// opções
		if (perguntaInicial == 1) {
			return removerAluno();
		} else if (perguntaInicial == 2) {
			return relatorio();
		} else if (perguntaInicial == 3) {
			return reiniciar();
		} else {
			alert(`Opção inválida!`);
			return telaInicial2();
		}
	}



	// função para reiniciar
	function reiniciar() {

		// recarrega a página
		location.reload(true);
	}



	// validador de notas
	function validador(pergunta) {


		// validação para as duas telas iniciais
		if (pergunta == `O que deseja realizar?\n\n1. Remover aluno;\n2. Aplicar as notas.`) {

			// transforma em texto para validação
			pergunta = prompt(pergunta);

			// validação e depois transforma em número com o parseInt
			while ((pergunta != 1 && pergunta != 2)) {
				alert(`ERRO: A opção deve ser igual as das mostradas (1 ou 2)!`);
				pergunta = parseInt(prompt(`O que deseja realizar?\n\n1. Remover aluno;\n2. Aplicar as notas.`));
			}
			return pergunta;

			// segunta tela inical
		} else if (pergunta == `O que deseja realizar?\n\n1. Remover aluno;\n2. Ver relatório;\n3. Reiniciar.`) {

			pergunta = prompt(pergunta);

			while ((pergunta != 1 && pergunta != 2 && pergunta != 3)) {
				alert(`ERRO: A opção deve ser igual as das mostradas (1, 2 ou 3)!`);
				pergunta = parseInt(prompt(`O que deseja realizar?\n\n1. Remover aluno;\n2. Ver relatório;\n3. Reiniciar.`));
			}
			return pergunta;



			// validação para as notas
		} else {

			// diferenciação para o prompt dar certo caso for vazio
			let notaParaVazio = prompt(pergunta);
			let nota = Number(notaParaVazio);


			while (isNaN(nota) || nota < 0 || nota > 10 || notaParaVazio == ``) {

				// explicando cada erro do usuário
				if (isNaN(nota)) {
					alert(`ERRO: A nota deve ser número!`);
				} else if (nota < 0 || nota > 10) {
					alert(`ERRO: A nota deve estar entre 0 e 10!`);
				} else if (notaParaVazio == ``) {
					alert(`ERRO: Digite a nota!`);
				}
				notaParaVazio = prompt(pergunta);
				nota = Number(notaParaVazio);
			}

			return nota;
		}
	}



	// função para remover aluno
	function removerAluno() {

		// se não tem alunos mostra a mensagem
		if (alunos.length == 0) {
			alert("Não há alunos cadastrados para remover!");
			return telaInicial2();
		}

		let removerAluno = prompt(`Digite o nome do aluno que deseja remover:\n\n${alunos.join(`;\n`)}.`);

		/*
		// procura o aluno na lista
		let nomeNormalizado = normalizar(removerAluno);
		let index = -1;

		// procura manualmente
		for (let i = 0; i < alunos.length; i++) {
			if (normalizar(alunos[i]) === nomeNormalizado) {
				index = i;
				break;
			}
		}

		a segunda parte da função normalizar que tentei usar mas não consegui explicar direito
		*/

		// procura o aluno na lista
		let index = alunos.indexOf(removerAluno);

		if (index !== -1) {
			// remove o aluno da lista
			alunos.splice(index, 1);
			alert(`Aluno ${removerAluno} removido com sucesso!`);
		} else {
			alert(`Aluno não encontrado!`);
		}

		// if legal porque retorna para a tela inicial correta
		if (notas.length == 0) {
			return telaInicial1();
		}  else {
			return telaInicial2();
		}
	}




	// função para adicionar notas
	function adicionarNotas() {

		// se não tem alunos mostra a mensagem
		if (alunos.length == 0) {
			alert("Não há alunos para cadastrar notas!");
			return telaInicial2();
		}

		// para cada aluno, adiciona 4 notas
		for (let i = 0; i < alunos.length; i++) {
			let notasAluno = [];

			// adiciona 4 notas para o aluno
			for (let j = 0; j < 4; j++) {
				let nota = validador(`Digite a nota ${j + 1} do aluno ${alunos[i]}:`);
				notasAluno.push(nota);
			}
			notas.push(notasAluno);
		}

		return telaInicial2();
	}



	// função para calcular média
	function calcularMedia(notasAluno) {

		//calcula a média das notas do aluno
		let soma = 0;
		for (let i = 0; i < notasAluno.length; i++) {
			soma += notasAluno[i];
		}
		let calculoMedia = soma / notasAluno.length;
		return calculoMedia;
	}



	// função para classificar desempenho
	function desempenho(media) {

		// classifica o desempenho com base na média
		if (media >= 9) {
			return `Excelente`;
		} else if (media >= 8) {
			return `Bom`;
		} else if (media >= 6) {
			return `Na média`;
		} else {
			return `Abaixo da média`;
		}
	}



	// função para gerar relatório
	function relatorio() {

		// se não tem alunos mostra a mensagem
		if (alunos.length == 0) {
			alert("Não há alunos cadastrados para gerar relatório!");
			return telaInicial2();
		}

		// Aplica a média e a classificação para cada aluno
		for (let i = 0; i < alunos.length; i++) {

			// informações do relatório
			let media = calcularMedia(notas[i]);
			let classificacao = desempenho(media);

			// saída final
			alert(`Aluno: ${alunos[i]}\nNotas: ${notas[i].join(", ")}\nMédia: ${media.toFixed(2)}\nClassificação: ${classificacao}`);
		}
		return telaInicial2();
	}


	// inicia o programa
	telaInicial1();

</script>